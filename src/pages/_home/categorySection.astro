---
// src/pages/_home/categorySection.astro
import NewsCard from "@/components/cards/newsCard.astro";
import HeaderSection from "./headerSection.astro";
import { articlesHandler } from "@/lib/handlers/articles";

// 1. 定义组件接收的属性
interface Props {
  title: string;      // 版块标题，例如 "Tech World"
  categoryId: string; // 分类ID，例如 "technology" (需对应 content/categories 里的文件夹名)
  count?: number;     // 想显示多少篇文章，默认为 3
}

const { title, categoryId, count = 3 } = Astro.props;

// 2. 获取所有文章并进行筛选
const allArticles = articlesHandler.allArticles();
const filteredArticles = allArticles
  .filter((article) => article.data.category.id === categoryId)
  .slice(0, count);
---

{/* 只有当该分类下有文章时才显示这个版块 */}
{filteredArticles.length > 0 && (
  <section class="container pt-12 pb-0 space-y-4" data-pagefind-ignore="all">
    {/* 3. HeaderSection 链接到对应的分类页面 */}
    <HeaderSection
      title={title}
      link_title="View all"
      link_url={`/categories/${categoryId}/1`} 
    />
    
    {/* 4. 文章网格布局 (与 LatestNews 保持一致，或是根据需要调整) */}
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 gap-y-6">
      {
        filteredArticles.map((article, index) => (
          <NewsCard article={article} index={index} />
        ))
      }
    </div>
  </section>
)}